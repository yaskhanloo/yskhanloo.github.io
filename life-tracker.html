<!DOCTYPE HTML>
<html>
<head>
    <title>Life Goals Tracker | Yasaman Safarkhanlo</title>
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    <meta name="description" content="Personal goal tracking dashboard">
    <meta name="robots" content="noindex, nofollow">
    <link href="//fonts.googleapis.com/css?family=Roboto:400,100,300,700,500,900" rel="stylesheet" type="text/css">
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
    <style>
        /* Base styles */
        * {
            margin: 0;
            padding: 0;
            border: 0;
            font-size: 100%;
            font: inherit;
            vertical-align: baseline;
            box-sizing: border-box;
        }

        body {
            font-family: 'Roboto', sans-serif;
            font-weight: 300;
            line-height: 1.6;
            color: #444;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 20px;
        }

        /* Header */
        #header {
            background: rgba(255,255,255,0.95);
            backdrop-filter: blur(10px);
            box-shadow: 0 2px 20px rgba(0,0,0,0.1);
            padding: 20px 0;
            position: fixed;
            width: 100%;
            top: 0;
            z-index: 1000;
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        #logo h1 {
            font-size: 2em;
            font-weight: 700;
            color: #333;
            margin: 0;
        }

        #logo .tag {
            color: #888;
            font-size: 0.9em;
            font-weight: 400;
        }

        .sync-controls {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .sync-status {
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 500;
        }

        .sync-status.local {
            background: #ffc107;
            color: #856404;
        }

        .sync-status.synced {
            background: #28a745;
            color: white;
        }

        .sync-status.error {
            background: #dc3545;
            color: white;
        }

        .sync-btn {
            background: #667eea;
            color: white;
            padding: 8px 16px;
            border: none;
            border-radius: 20px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s;
        }

        .sync-btn:hover {
            background: #764ba2;
            transform: translateY(-1px);
        }

        /* Login form */
        .login-container {
            max-width: 500px;
            margin: 100px auto;
            background: rgba(255,255,255,0.95);
            backdrop-filter: blur(10px);
            padding: 40px;
            border-radius: 20px;
            box-shadow: 0 15px 35px rgba(0,0,0,0.1);
            text-align: center;
        }

        .login-form h2 {
            margin-bottom: 30px;
            color: #333;
            font-weight: 500;
        }

        .form-group {
            margin-bottom: 20px;
            text-align: left;
        }

        label {
            display: block;
            margin-bottom: 8px;
            color: #555;
            font-weight: 500;
        }

        input[type="password"], input[type="text"] {
            width: 100%;
            padding: 15px;
            border: 2px solid #eee;
            border-radius: 10px;
            font-size: 16px;
            transition: all 0.3s;
            background: rgba(255,255,255,0.9);
        }

        input[type="password"]:focus, input[type="text"]:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102,126,234,0.1);
        }

        .btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 15px 30px;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            font-size: 16px;
            width: 100%;
            transition: all 0.3s;
            margin-bottom: 10px;
            font-weight: 500;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(102,126,234,0.3);
        }

        /* Main content */
        #main {
            margin-top: 120px;
            min-height: calc(100vh - 120px);
            padding: 40px 0;
        }

        /* Goal categories grid */
        .goals-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 30px;
            margin-bottom: 40px;
        }

        .goal-category {
            background: rgba(255,255,255,0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            transition: all 0.3s;
            border-left: 6px solid var(--category-color);
        }

        .goal-category:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 40px rgba(0,0,0,0.15);
        }

        /* Category colors */
        .category-career { --category-color: #667eea; }
        .category-phd { --category-color: #f093fb; }
        .category-work { --category-color: #4facfe; }
        .category-health { --category-color: #43e97b; }
        .category-mental { --category-color: #fa709a; }
        .category-language { --category-color: #ffecd2; }
        .category-creativity { --category-color: #a8edea; }
        .category-finance { --category-color: #d299c2; }

        .category-header {
            display: flex;
            align-items: center;
            margin-bottom: 25px;
        }

        .category-icon {
            font-size: 2.5em;
            margin-right: 15px;
        }

        .category-title {
            font-size: 1.5em;
            font-weight: 600;
            color: #333;
        }

        .category-subtitle {
            font-size: 0.9em;
            color: #666;
            margin-top: 5px;
        }

        /* Progress bar */
        .progress-container {
            background: #f0f0f0;
            border-radius: 15px;
            height: 8px;
            margin: 20px 0;
            overflow: hidden;
        }

        .progress-bar {
            height: 100%;
            background: linear-gradient(90deg, var(--category-color), var(--category-color));
            border-radius: 15px;
            transition: width 0.5s ease;
        }

        /* Big goals */
        .big-goals {
            margin-bottom: 25px;
        }

        .big-goals h4 {
            font-size: 1.1em;
            font-weight: 600;
            color: #333;
            margin-bottom: 15px;
        }

        .big-goal-item {
            background: rgba(102,126,234,0.1);
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 10px;
            font-size: 0.95em;
            color: #444;
        }

        /* Mini goals */
        .mini-goals h4 {
            font-size: 1.1em;
            font-weight: 600;
            color: #333;
            margin-bottom: 15px;
        }

        .mini-goal-item {
            display: flex;
            align-items: center;
            padding: 12px 0;
            border-bottom: 1px solid #f0f0f0;
        }

        .mini-goal-item:last-child {
            border-bottom: none;
        }

        .mini-goal-checkbox {
            margin-right: 15px;
            transform: scale(1.3);
            cursor: pointer;
        }

        .mini-goal-text {
            flex: 1;
            font-size: 0.95em;
            transition: all 0.3s;
        }

        .mini-goal-text.completed {
            text-decoration: line-through;
            color: #888;
        }

        .mini-goal-date {
            font-size: 0.8em;
            color: #999;
            margin-left: 10px;
        }

        /* Add goal form */
        .add-goal-form {
            margin-top: 20px;
            padding-top: 20px;
            border-top: 2px solid #f0f0f0;
        }

        .add-goal-input {
            display: flex;
            gap: 10px;
            margin-bottom: 10px;
        }

        .add-goal-input input {
            flex: 1;
            padding: 10px 15px;
            border: 2px solid #eee;
            border-radius: 10px;
            font-size: 14px;
        }

        .add-goal-input button {
            background: var(--category-color);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 10px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.3s;
        }

        .add-goal-input button:hover {
            transform: translateY(-1px);
            opacity: 0.9;
        }

        /* Special sections */
        .phd-countdown {
            background: linear-gradient(135deg, #f093fb, #f5576c);
            color: white;
            text-align: center;
            padding: 30px;
            border-radius: 20px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(240,147,251,0.3);
        }

        .countdown-timer {
            font-size: 3em;
            font-weight: 700;
            margin: 20px 0;
        }

        .countdown-label {
            font-size: 1.2em;
            opacity: 0.9;
        }

        /* Weight tracker */
        .weight-tracker {
            background: linear-gradient(135deg, #43e97b, #38f9d7);
            color: white;
            padding: 25px;
            border-radius: 15px;
            margin: 20px 0;
            text-align: center;
        }

        .weight-current {
            font-size: 2.5em;
            font-weight: 700;
        }

        .weight-goal {
            font-size: 1.1em;
            opacity: 0.9;
            margin-top: 10px;
        }

        /* Navigation tabs */
        .nav-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }

        .nav-tab {
            background: rgba(255,255,255,0.8);
            color: #666;
            padding: 12px 24px;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.3s;
        }

        .nav-tab.active {
            background: rgba(255,255,255,1);
            color: #333;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .nav-tab:hover {
            background: rgba(255,255,255,1);
            transform: translateY(-1px);
        }

        /* Stats dashboard */
        .stats-dashboard {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 40px;
        }

        .stat-card {
            background: rgba(255,255,255,0.95);
            backdrop-filter: blur(10px);
            padding: 25px;
            border-radius: 15px;
            text-align: center;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
        }

        .stat-number {
            font-size: 2.5em;
            font-weight: 700;
            color: #667eea;
            margin-bottom: 5px;
        }

        .stat-label {
            color: #666;
            font-size: 0.9em;
        }

        /* Hidden sections */
        .tracker-interface {
            display: none;
        }

        .tracker-interface.active {
            display: block;
        }

        /* Responsive */
        @media screen and (max-width: 768px) {
            .goals-grid {
                grid-template-columns: 1fr;
                gap: 20px;
            }
            
            .goal-category {
                padding: 20px;
            }
            
            .header-content {
                flex-direction: column;
                gap: 15px;
            }
            
            .nav-tabs {
                justify-content: center;
            }
            
            .stats-dashboard {
                grid-template-columns: repeat(2, 1fr);
                gap: 15px;
            }
        }

        /* Animations */
        @keyframes slideInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .goal-category {
            animation: slideInUp 0.6s ease forwards;
        }

        .goal-category:nth-child(1) { animation-delay: 0.1s; }
        .goal-category:nth-child(2) { animation-delay: 0.2s; }
        .goal-category:nth-child(3) { animation-delay: 0.3s; }
        .goal-category:nth-child(4) { animation-delay: 0.4s; }

        /* Loading state */
        .loading {
            opacity: 0;
        }

        /* Success animations */
        .goal-completed {
            animation: pulse 0.6s ease;
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
    </style>
</head>
<body>

    <!-- Header -->
    <div id="header">
        <div class="container">
            <div class="header-content">
                <div id="logo">
                    <h1>🎯 Life Goals Tracker</h1>
                    <span class="tag">Your Journey to Success</span>
                </div>
                <div class="sync-controls" id="syncControls" style="display: none;">
                    <span class="sync-status local" id="syncStatus">Local Only</span>
                    <button class="sync-btn" id="syncBtn" onclick="syncData()">Sync</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Login Form -->
    <div class="login-container" id="loginContainer">
        <div class="login-form">
            <h2>🔐 Access Your Goals</h2>
            <div class="form-group">
                <label for="password">Password:</label>
                <input type="password" id="password" placeholder="Enter your password">
            </div>
            <button class="btn" onclick="login()">Access Dashboard</button>
            <div class="error" id="errorMsg"></div>
        </div>
    </div>

    <!-- Main Tracker Interface -->
    <div id="main">
        <div class="container">
            <div class="tracker-interface" id="trackerInterface">
                
                <!-- PhD Countdown (Special Section) -->
                <div class="phd-countdown">
                    <h2>🎓 PhD Defense Countdown</h2>
                    <div class="countdown-timer" id="phdCountdown">Loading...</div>
                    <div class="countdown-label">until August 25, 2025 - 9:00 AM</div>
                </div>

                <!-- Navigation Tabs -->
                <div class="nav-tabs">
                    <button class="nav-tab active" onclick="showView('all')">All Goals</button>
                    <button class="nav-tab" onclick="showView('today')">Today's Tasks</button>
                    <button class="nav-tab" onclick="showView('stats')">Progress Stats</button>
                    <button class="nav-tab" onclick="showView('journal')">Daily Journal</button>
                </div>

                <!-- Stats Dashboard -->
                <div class="stats-dashboard" id="statsDashboard">
                    <div class="stat-card">
                        <div class="stat-number" id="totalProgress">0%</div>
                        <div class="stat-label">Overall Progress</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="completedToday">0</div>
                        <div class="stat-label">Completed Today</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="activeGoals">0</div>
                        <div class="stat-label">Active Goals</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="weekStreak">0</div>
                        <div class="stat-label">Day Streak</div>
                    </div>
                </div>

                <!-- Goals Grid -->
                <div class="goals-grid" id="goalsGrid">
                    <!-- Goal categories will be loaded here -->
                </div>

                <!-- Journal Section (Hidden by default) -->
                <div id="journalSection" style="display: none;">
                    <div style="background: rgba(255,255,255,0.95); padding: 30px; border-radius: 20px; box-shadow: 0 10px 30px rgba(0,0,0,0.1);">
                        <h2 style="margin-bottom: 20px; color: #333;">📝 Daily Reflection</h2>
                        <div style="margin-bottom: 15px; font-weight: 500; color: #666;" id="journalDate"></div>
                        <textarea id="journalText" placeholder="How was your day? What progress did you make? What are you grateful for?" 
                                  style="width: 100%; min-height: 200px; padding: 20px; border: 2px solid #eee; border-radius: 15px; font-family: inherit; resize: vertical;"></textarea>
                        <button onclick="saveJournal()" style="background: linear-gradient(135deg, #667eea, #764ba2); color: white; padding: 15px 30px; border: none; border-radius: 25px; cursor: pointer; font-size: 16px; margin-top: 15px;">Save Entry</button>
                    </div>
                </div>

            </div>
        </div>
    </div>

    <script>
        // Configuration
        const CORRECT_PASSWORD = "YourGoalsPassword2025";
        
        // Goal categories data structure
        const GOAL_CATEGORIES = {
            career: {
                title: "Career & Learning",
                icon: "🧠",
                color: "#667eea",
                bigGoals: [
                    "Become an NLP expert with broad AI/data science knowledge",
                    "Build lightweight, interpretable NLP tools (e.g. for stroke MRI reports)",
                    "Publish/postdoc in the field OR transition to a top industry role",
                    "Learn Docker, deploy microservices, master code pipelines"
                ],
                miniGoals: [
                    "Finish Dockerizing import/validation tools",
                    "Finish NLP clinical tagger MVP",
                    "Read 1 paper or blog post per week",
                    "Build a portfolio project to showcase (with GitHub + Streamlit)"
                ]
            },
            phd: {
                title: "PhD Completion",
                icon: "🎓",
                color: "#f093fb",
                bigGoals: [
                    "Successfully defend PhD (Defense: Aug 25, 2025, 9 AM)",
                    "Turn it into a publication or series of talks"
                ],
                miniGoals: [
                    "Prepare slides & script post-Wacken",
                    "Practice defense weekly in August"
                ]
            },
            work: {
                title: "Work & Residency",
                icon: "🏥",
                color: "#4facfe",
                bigGoals: [
                    "Keep current job until C permit in 2027",
                    "Secure a working B permit in 2025",
                    "Stabilize life in Bern with legal + job security"
                ],
                miniGoals: [
                    "Finalize permit paperwork (with a-link/lawyer)",
                    "Keep work portfolio updated",
                    "Regular check-ins on satisfaction & burnout"
                ]
            },
            health: {
                title: "Health & Fitness",
                icon: "🧍‍♀️",
                color: "#43e97b",
                bigGoals: [
                    "Reach 80 kg by Jan 2026, 95 kg by end of July",
                    "Reverse insulin resistance & improve energy levels",
                    "Stay consistent with gym, tracking, and food choices"
                ],
                miniGoals: [
                    "Gym 3-4x/week (Apple Fitness+ log)",
                    "Log all meals in MyFitnessPal",
                    "Weekly weigh-in + progress photo"
                ]
            },
            mental: {
                title: "Mental Health & Balance",
                icon: "🧘",
                color: "#fa709a",
                bigGoals: [
                    "Keep life joyful, not just productive",
                    "Journal, meditate, and garden regularly",
                    "Rebuild Instagram as a motivational/private visual diary"
                ],
                miniGoals: [
                    "Meditate 3x/week",
                    "Journal every night",
                    "Post 1 photo/story per week on @yaskhanloo"
                ]
            },
            language: {
                title: "Language Learning",
                icon: "🗣️",
                color: "#ffd89b",
                bigGoals: [
                    "Reach C1 German",
                    "Finish Menschen book series (currently B1.2)"
                ],
                miniGoals: [
                    "Study 4x/week for 30 minutes",
                    "Flashcard review with Anki",
                    "Watch 1 German show or video per week"
                ]
            },
            creativity: {
                title: "Creativity & Hobbies",
                icon: "🎹",
                color: "#a8edea",
                bigGoals: [
                    "Buy compact piano & play again",
                    "Bake, garden, and explore art consistently"
                ],
                miniGoals: [
                    "Research budget pianos",
                    "Practice 2x/week once bought",
                    "Schedule creative time each weekend"
                ]
            },
            finance: {
                title: "Finance & Stability",
                icon: "💰",
                color: "#d299c2",
                bigGoals: [
                    "Build emergency fund",
                    "Start 3rd pillar pension contributions",
                    "Save for creative tools/travel"
                ],
                miniGoals: [
                    "Monthly budget check",
                    "Save X CHF/month",
                    "Track spending (esp. subscriptions, groceries)"
                ]
            }
        };

        // Storage keys
        const STORAGE_KEYS = {
            goals: 'goalTracker_goals',
            journal: 'goalTracker_journal',
            progress: 'goalTracker_progress',
            lastSync: 'goalTracker_lastSync'
        };

        let currentView = 'all';
        let goalsData = {};

        // Login functionality
        function login() {
            const password = document.getElementById('password').value;
            const errorMsg = document.getElementById('errorMsg');
            
            if (password === CORRECT_PASSWORD) {
                document.getElementById('loginContainer').style.display = 'none';
                document.getElementById('trackerInterface').style.display = 'block';
                initializeTracker();
            } else {
                errorMsg.textContent = 'Incorrect password. Please try again.';
                errorMsg.style.color = '#e74c3c';
                setTimeout(() => errorMsg.textContent = '', 3000);
            }
        }

        // Allow Enter key to login
        document.getElementById('password').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                login();
            }
        });

        // Initialize tracker
        function initializeTracker() {
            loadGoalsData();
            setupPhdCountdown();
            renderGoalsGrid();
            updateStats();
            setupJournal();
            
            // Set initial animation delays
            setTimeout(() => {
                document.querySelectorAll('.goal-category').forEach((card, index) => {
                    card.style.animationDelay = `${index * 0.1}s`;
                });
            }, 100);
        }

        // Load goals data from localStorage
        function loadGoalsData() {
            const saved = localStorage.getItem(STORAGE_KEYS.goals);
            if (saved) {
                goalsData = JSON.parse(saved);
            } else {
                // Initialize with default structure
                goalsData = {};
                Object.keys(GOAL_CATEGORIES).forEach(categoryKey => {
                    goalsData[categoryKey] = {
                        miniGoals: GOAL_CATEGORIES[categoryKey].miniGoals.map(goal => ({
                            text: goal,
                            completed: false,
                            completedDate: null
                        })),
                        customGoals: []
                    };
                });
                saveGoalsData();
            }
        }

        // Save goals data to localStorage
        function saveGoalsData() {
            localStorage.setItem(STORAGE_KEYS.goals, JSON.stringify(goalsData));
        }

        // PhD Countdown
        function setupPhdCountdown() {
            const defenseDate = new Date('2025-08-25T09:00:00');
            
            function updateCountdown() {
                const now = new Date();
                const timeLeft = defenseDate - now;
                
                if (timeLeft > 0) {
                    const days = Math.floor(timeLeft / (1000 * 60 * 60 * 24));
                    const hours = Math.floor((timeLeft % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
                    const minutes = Math.floor((timeLeft % (1000 * 60 * 60)) / (1000 * 60));
                    
                    document.getElementById('phdCountdown').textContent = `${days}d ${hours}h ${minutes}m`;
                } else {
                    document.getElementById('phdCountdown').textContent = "🎉 Defense Day!";
                }
            }
            
            updateCountdown();
            setInterval(updateCountdown, 60000); // Update every minute
        }

        // Render goals grid
        function renderGoalsGrid() {
            const grid = document.getElementById('goalsGrid');
            grid.innerHTML = '';
            
            Object.keys(GOAL_CATEGORIES).forEach(categoryKey => {
                const category = GOAL_CATEGORIES[categoryKey];
                const categoryData = goalsData[categoryKey];
                
                // Calculate progress
                const totalMiniGoals = categoryData.miniGoals.length + categoryData.customGoals.length;
                const completedMiniGoals = [...categoryData.miniGoals, ...categoryData.customGoals]
                    .filter(goal => goal.completed).length;
                const progress = totalMiniGoals > 0 ? Math.round((completedMiniGoals / totalMiniGoals) * 100) : 0;
                
                const categoryHTML = `
                    <div class="goal-category category-${categoryKey}" style="--category-color: ${category.color}">
                        <div class="category-header">
                            <div class="category-icon">${category.icon}</div>
                            <div>
                                <div class="category-title">${category.title}</div>
                                <div class="category-subtitle">${completedMiniGoals}/${totalMiniGoals} completed</div>
                            </div>
                        </div>
                        
                        <div class="progress-container">
                            <div class="progress-bar" style="width: ${progress}%"></div>
                        </div>
                        
                        ${categoryKey === 'health' ? renderWeightTracker() : ''}
                        
                        <div class="big-goals">
                            <h4>🎯 Big Goals</h4>
                            ${category.bigGoals.map(goal => `
                                <div class="big-goal-item">${goal}</div>
                            `).join('')}
                        </div>
                        
                        <div class="mini-goals">
                            <h4>✅ Mini Goals</h4>
                            ${renderMiniGoals(categoryKey, categoryData)}
                        </div>
                        
                        <div class="add-goal-form">
                            <div class="add-goal-input">
                                <input type="text" placeholder="Add a new mini-goal..." id="newGoal_${categoryKey}">
                                <button onclick="addCustomGoal('${categoryKey}')">Add</button>
                            </div>
                        </div>
                    </div>
                `;
                
                grid.innerHTML += categoryHTML;
            });
        }

        // Render mini goals for a category
        function renderMiniGoals(categoryKey, categoryData) {
            const allGoals = [...categoryData.miniGoals, ...categoryData.customGoals];
            
            return allGoals.map((goal, index) => {
                const isCustom = index >= categoryData.miniGoals.length;
                const actualIndex = isCustom ? index - categoryData.miniGoals.length : index;
                
                return `
                    <div class="mini-goal-item">
                        <input type="checkbox" class="mini-goal-checkbox" 
                               ${goal.completed ? 'checked' : ''} 
                               onchange="toggleGoal('${categoryKey}', ${actualIndex}, ${isCustom})">
                        <span class="mini-goal-text ${goal.completed ? 'completed' : ''}">${goal.text}</span>
                        ${goal.completedDate ? `<span class="mini-goal-date">${new Date(goal.completedDate).toLocaleDateString()}</span>` : ''}
                        ${isCustom ? `<button onclick="removeCustomGoal('${categoryKey}', ${actualIndex})" style="background: #dc3545; color: white; border: none; padding: 5px 10px; border-radius: 5px; margin-left: 10px; cursor: pointer;">×</button>` : ''}
                    </div>
                `;
            }).join('');
        }

        // Render weight tracker for health category
        function renderWeightTracker() {
            const currentWeight = localStorage.getItem('currentWeight') || '100';
            const targetWeight = '80';
            const progress = Math.max(0, Math.min(100, ((100 - currentWeight) / (100 - targetWeight)) * 100));
            
            return `
                <div class="weight-tracker">
                    <div style="display: flex; justify-content: space-between; align-items: center;">
                        <div>
                            <div class="weight-current">${currentWeight}kg</div>
                            <div class="weight-goal">Goal: ${targetWeight}kg by Jan 2026</div>
                        </div>
                        <button onclick="updateWeight()" style="background: rgba(255,255,255,0.2); color: white; border: 2px solid white; padding: 10px 20px; border-radius: 10px; cursor: pointer;">Update</button>
                    </div>
                    <div style="background: rgba(255,255,255,0.2); height: 8px; border-radius: 10px; margin-top: 15px;">
                        <div style="background: white; height: 100%; width: ${progress}%; border-radius: 10px; transition: width 0.5s;"></div>
                    </div>
                </div>
            `;
        }

        // Toggle goal completion
        function toggleGoal(categoryKey, goalIndex, isCustom) {
            const goalArray = isCustom ? goalsData[categoryKey].customGoals : goalsData[categoryKey].miniGoals;
            const goal = goalArray[goalIndex];
            
            goal.completed = !goal.completed;
            goal.completedDate = goal.completed ? new Date().toISOString() : null;
            
            saveGoalsData();
            renderGoalsGrid();
            updateStats();
            
            // Add celebration animation for completion
            if (goal.completed) {
                const categoryElement = document.querySelector(`.category-${categoryKey}`);
                categoryElement.classList.add('goal-completed');
                setTimeout(() => categoryElement.classList.remove('goal-completed'), 600);
            }
        }

        // Add custom goal
        function addCustomGoal(categoryKey) {
            const input = document.getElementById(`newGoal_${categoryKey}`);
            const goalText = input.value.trim();
            
            if (!goalText) return;
            
            goalsData[categoryKey].customGoals.push({
                text: goalText,
                completed: false,
                completedDate: null
            });
            
            input.value = '';
            saveGoalsData();
            renderGoalsGrid();
            updateStats();
        }

        // Remove custom goal
        function removeCustomGoal(categoryKey, goalIndex) {
            if (!confirm('Remove this goal?')) return;
            
            goalsData[categoryKey].customGoals.splice(goalIndex, 1);
            saveGoalsData();
            renderGoalsGrid();
            updateStats();
        }

        // Update weight
        function updateWeight() {
            const newWeight = prompt('Enter your current weight (kg):');
            if (newWeight && !isNaN(newWeight)) {
                localStorage.setItem('currentWeight', newWeight);
                renderGoalsGrid();
            }
        }

        // Update statistics
        function updateStats() {
            let totalGoals = 0;
            let completedGoals = 0;
            let completedToday = 0;
            
            const today = new Date().toDateString();
            
            Object.keys(goalsData).forEach(categoryKey => {
                const categoryData = goalsData[categoryKey];
                const allGoals = [...categoryData.miniGoals, ...categoryData.customGoals];
                
                totalGoals += allGoals.length;
                allGoals.forEach(goal => {
                    if (goal.completed) {
                        completedGoals++;
                        if (goal.completedDate && new Date(goal.completedDate).toDateString() === today) {
                            completedToday++;
                        }
                    }
                });
            });
            
            const overallProgress = totalGoals > 0 ? Math.round((completedGoals / totalGoals) * 100) : 0;
            const streak = calculateStreak();
            
            document.getElementById('totalProgress').textContent = `${overallProgress}%`;
            document.getElementById('completedToday').textContent = completedToday;
            document.getElementById('activeGoals').textContent = totalGoals - completedGoals;
            document.getElementById('weekStreak').textContent = streak;
        }

        // Calculate streak (simplified)
        function calculateStreak() {
            const journalData = JSON.parse(localStorage.getItem(STORAGE_KEYS.journal)) || {};
            const dates = Object.keys(journalData).sort().reverse();
            
            let streak = 0;
            const today = new Date();
            
            for (let i = 0; i < dates.length; i++) {
                const date = new Date(dates[i]);
                const diffDays = Math.floor((today - date) / (1000 * 60 * 60 * 24));
                
                if (diffDays === i) {
                    streak++;
                } else {
                    break;
                }
            }
            
            return streak;
        }

        // View switching
        function showView(viewType) {
            currentView = viewType;
            
            // Update active tab
            document.querySelectorAll('.nav-tab').forEach(tab => tab.classList.remove('active'));
            event.target.classList.add('active');
            
            const goalsGrid = document.getElementById('goalsGrid');
            const statsBoard = document.getElementById('statsDashboard');
            const journalSection = document.getElementById('journalSection');
            
            // Hide all sections first
            goalsGrid.style.display = 'none';
            statsBoard.style.display = 'none';
            journalSection.style.display = 'none';
            
            switch(viewType) {
                case 'all':
                    goalsGrid.style.display = 'grid';
                    statsBoard.style.display = 'grid';
                    break;
                case 'today':
                    renderTodayTasks();
                    goalsGrid.style.display = 'grid';
                    statsBoard.style.display = 'grid';
                    break;
                case 'stats':
                    renderDetailedStats();
                    statsBoard.style.display = 'grid';
                    break;
                case 'journal':
                    journalSection.style.display = 'block';
                    loadJournal();
                    break;
            }
        }

        // Render today's tasks
        function renderTodayTasks() {
            const grid = document.getElementById('goalsGrid');
            grid.innerHTML = '';
            
            // Filter categories that have incomplete goals
            const activeCategories = Object.keys(GOAL_CATEGORIES).filter(categoryKey => {
                const categoryData = goalsData[categoryKey];
                const allGoals = [...categoryData.miniGoals, ...categoryData.customGoals];
                return allGoals.some(goal => !goal.completed);
            });
            
            activeCategories.forEach(categoryKey => {
                const category = GOAL_CATEGORIES[categoryKey];
                const categoryData = goalsData[categoryKey];
                const incompleteGoals = [...categoryData.miniGoals, ...categoryData.customGoals]
                    .filter(goal => !goal.completed);
                
                if (incompleteGoals.length === 0) return;
                
                const categoryHTML = `
                    <div class="goal-category category-${categoryKey}" style="--category-color: ${category.color}">
                        <div class="category-header">
                            <div class="category-icon">${category.icon}</div>
                            <div>
                                <div class="category-title">${category.title}</div>
                                <div class="category-subtitle">${incompleteGoals.length} tasks remaining</div>
                            </div>
                        </div>
                        
                        <div class="mini-goals">
                            <h4>🎯 Focus for Today</h4>
                            ${incompleteGoals.slice(0, 3).map((goal, index) => {
                                const originalIndex = [...categoryData.miniGoals, ...categoryData.customGoals].indexOf(goal);
                                const isCustom = originalIndex >= categoryData.miniGoals.length;
                                const actualIndex = isCustom ? originalIndex - categoryData.miniGoals.length : originalIndex;
                                
                                return `
                                    <div class="mini-goal-item">
                                        <input type="checkbox" class="mini-goal-checkbox" 
                                               onchange="toggleGoal('${categoryKey}', ${actualIndex}, ${isCustom})">
                                        <span class="mini-goal-text">${goal.text}</span>
                                    </div>
                                `;
                            }).join('')}
                        </div>
                    </div>
                `;
                
                grid.innerHTML += categoryHTML;
            });
        }

        // Render detailed stats
        function renderDetailedStats() {
            const grid = document.getElementById('goalsGrid');
            grid.innerHTML = '';
            
            // Category progress breakdown
            const statsHTML = Object.keys(GOAL_CATEGORIES).map(categoryKey => {
                const category = GOAL_CATEGORIES[categoryKey];
                const categoryData = goalsData[categoryKey];
                const allGoals = [...categoryData.miniGoals, ...categoryData.customGoals];
                const completed = allGoals.filter(goal => goal.completed).length;
                const total = allGoals.length;
                const progress = total > 0 ? Math.round((completed / total) * 100) : 0;
                
                return `
                    <div class="goal-category category-${categoryKey}" style="--category-color: ${category.color}">
                        <div class="category-header">
                            <div class="category-icon">${category.icon}</div>
                            <div>
                                <div class="category-title">${category.title}</div>
                                <div class="category-subtitle">Detailed Progress</div>
                            </div>
                        </div>
                        
                        <div style="text-align: center; padding: 20px;">
                            <div style="font-size: 3em; font-weight: 700; color: ${category.color}; margin-bottom: 10px;">${progress}%</div>
                            <div style="font-size: 1.1em; color: #666; margin-bottom: 15px;">${completed} of ${total} completed</div>
                            
                            <div class="progress-container">
                                <div class="progress-bar" style="width: ${progress}%"></div>
                            </div>
                            
                            <div style="margin-top: 20px; text-align: left;">
                                <div style="font-weight: 600; margin-bottom: 10px;">Recent Completions:</div>
                                ${allGoals.filter(goal => goal.completed && goal.completedDate)
                                    .sort((a, b) => new Date(b.completedDate) - new Date(a.completedDate))
                                    .slice(0, 3)
                                    .map(goal => `
                                        <div style="font-size: 0.9em; color: #666; margin-bottom: 5px;">
                                            ✅ ${goal.text} 
                                            <span style="color: #999;">(${new Date(goal.completedDate).toLocaleDateString()})</span>
                                        </div>
                                    `).join('') || '<div style="font-size: 0.9em; color: #999;">No completions yet</div>'}
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
            
            grid.innerHTML = statsHTML;
        }

        // Journal functionality
        function setupJournal() {
            const today = new Date().toLocaleDateString('en-US', {
                weekday: 'long',
                year: 'numeric',
                month: 'long',
                day: 'numeric'
            });
            document.getElementById('journalDate').textContent = today;
        }

        function loadJournal() {
            const today = new Date().toDateString();
            const journal = JSON.parse(localStorage.getItem(STORAGE_KEYS.journal)) || {};
            const todayEntry = journal[today] || '';
            
            document.getElementById('journalText').value = todayEntry;
        }

        function saveJournal() {
            const today = new Date().toDateString();
            const text = document.getElementById('journalText').value;
            const journal = JSON.parse(localStorage.getItem(STORAGE_KEYS.journal)) || {};
            
            if (text.trim()) {
                journal[today] = text;
            } else {
                delete journal[today];
            }
            
            localStorage.setItem(STORAGE_KEYS.journal, JSON.stringify(journal));
            updateStats();
            
            // Show save confirmation
            const btn = event.target;
            const originalText = btn.textContent;
            btn.textContent = '✅ Saved!';
            setTimeout(() => btn.textContent = originalText, 2000);
        }

        // Data export functionality
        function exportData() {
            const allData = {
                goals: goalsData,
                journal: JSON.parse(localStorage.getItem(STORAGE_KEYS.journal)) || {},
                currentWeight: localStorage.getItem('currentWeight') || '100',
                exportDate: new Date().toISOString()
            };

            const dataStr = JSON.stringify(allData, null, 2);
            const dataBlob = new Blob([dataStr], {type: 'application/json'});
            
            const link = document.createElement('a');
            link.href = URL.createObjectURL(dataBlob);
            link.download = `life-goals-backup-${new Date().toISOString().split('T')[0]}.json`;
            link.click();
        }

        // Sync functionality placeholder
        function syncData() {
            // This could be expanded to sync with GitHub, Google Drive, etc.
            console.log('Sync functionality - to be implemented');
            
            const syncBtn = document.getElementById('syncBtn');
            const originalText = syncBtn.textContent;
            syncBtn.textContent = 'Synced!';
            setTimeout(() => syncBtn.textContent = originalText, 2000);
        }

        // Auto-save functionality
        setInterval(() => {
            saveGoalsData();
        }, 30000); // Auto-save every 30 seconds

        // Keyboard shortcuts
        document.addEventListener('keydown', function(e) {
            if (e.ctrlKey || e.metaKey) {
                switch(e.key) {
                    case 's':
                        e.preventDefault();
                        saveJournal();
                        break;
                    case 'e':
                        e.preventDefault();
                        exportData();
                        break;
                }
            }
        });

        // Initialize animations
        document.addEventListener('DOMContentLoaded', function() {
            // Add loading state
            document.body.classList.add('loading');
            setTimeout(() => {
                document.body.classList.remove('loading');
            }, 500);
        });
    </script>

</body>
</html>
